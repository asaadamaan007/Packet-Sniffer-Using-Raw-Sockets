Compile and Run

$ gcc sniffer.c && sudo ./a.out
The program must be run as root user or superuser privileges. e.g. sudo ./a.out in ubuntu
The program creates raw sockets which require root access.